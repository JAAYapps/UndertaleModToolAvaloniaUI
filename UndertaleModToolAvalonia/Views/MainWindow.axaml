<views:UndertaleWindow xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:UndertaleModToolAvalonia.ViewModels.StartPageViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewModels="clr-namespace:UndertaleModToolAvalonia.ViewModels"
		xmlns:views="using:UndertaleModToolAvalonia.Views"
		xmlns:c="using:Avalonia.Controls"
		xmlns:wnd="using:FluentAvalonia.UI.Windowing"
		xmlns:ui="using:FluentAvalonia.UI.Controls"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="UndertaleModToolAvalonia.Views.MainWindow"
		x:DataType="viewModels:MainWindowViewModel"
        Icon="/Assets/icon.ico" WindowStartupLocation="CenterScreen"
        TransparencyLevelHint="AcrylicBlur"
        Background="Transparent"
		Margin="-8"
        SystemDecorations="BorderOnly">
	<wnd:AppWindow.Title>
		<MultiBinding StringFormat="{}{0} - {1} [{2}]">
			<Binding Path="TitleMain"/>
			<Binding Path="Data.GeneralInfo" FallbackValue="No game loaded"/>
			<Binding Path="FilePath"/>
		</MultiBinding>
	</wnd:AppWindow.Title>
	<Grid>
		<Panel IsHitTestVisible="true">
			<ExperimentalAcrylicBorder IsHitTestVisible="False">
				<ExperimentalAcrylicBorder.Material>
					<ExperimentalAcrylicMaterial
						BackgroundSource="Digger"
						TintColor="{DynamicResource AcrylicTintColor}"
						TintOpacity="1"
						MaterialOpacity="0.95" />
				</ExperimentalAcrylicBorder.Material>
			</ExperimentalAcrylicBorder>

			<Grid Name="MainContentGrid" Focusable="True" Margin="0,0,0,0">
				<Grid.RowDefinitions>
					<RowDefinition Height="33"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>
				<Grid Grid.Row="0" x:Name="CustomTitleBar" Margin="0,0,0,0" IsHitTestVisible="True" Background="Transparent"
								  VerticalAlignment="Center" ColumnDefinitions="Auto,Auto,*,Auto,Auto,Auto"
								  PointerPressed="TitleBar_OnPointerPressed" DoubleTapped="CustomTitleBar_OnDoubleTapped">

					<Image Grid.Column="0" Width="18" Source="/Assets/icon.ico" Margin="7,0,7,0"/>
					<TextBlock Grid.Column="1" FontSize="12" Text="{Binding Title, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}" HorizontalAlignment="Left" VerticalAlignment="Center" />

					<Button Grid.Column="3" Margin="0,-1,-2,0" Width="48" Height="34" VerticalAlignment="Top" Click="Minimize_OnClick">
						<Button.Styles>
							<Style Selector="Button:pointerover /template/ ContentPresenter">
								<Setter Property="Background" Value="#20FFFFFF"/>
							</Style>
							<Style Selector="Button:pressed /template/ ContentPresenter">
								<Setter Property="Background" Value="#18FFFFFF"/>
							</Style>
						</Button.Styles>
						<PathIcon Data="{StaticResource MinimizeIcon}" Width="10"/>
					</Button>

					<Button Grid.Column="4" Margin="0,-1,-2,0" Width="48" Height="34" VerticalAlignment="Top" Click="Maximize_OnClick">
						<Button.Styles>
							<Style Selector="Button:pointerover /template/ ContentPresenter">
								<Setter Property="Background" Value="#20FFFFFF"/>
							</Style>
							<Style Selector="Button:pressed /template/ ContentPresenter">
								<Setter Property="Background" Value="#18FFFFFF"/>
							</Style>
						</Button.Styles>
						<PathIcon Data="{Binding ToggleIconData}" Width="10"/>
					</Button>

					<Button Grid.Column="5" Width="48" Height="34" Margin="0,-1,-1,0" VerticalAlignment="Top" Click="Close_OnClick">
						<Button.Styles>
							<Style Selector="Button:pointerover /template/ ContentPresenter">
								<Setter Property="Background" Value="Red"/>
							</Style>
							<Style Selector="Button:pressed /template/ ContentPresenter">
								<Setter Property="Background" Value="LightCoral"/>
							</Style>
						</Button.Styles>
						<PathIcon Data="{StaticResource close}" Margin="0,1,0,0" Width="10"/>
					</Button>
				</Grid>


				<SplitView Grid.Row="1" Margin="0,0,0,0" IsPaneOpen="{Binding IsPaneOpen}" OpenPaneLength="300" CompactPaneLength="46" DisplayMode="CompactInline" >
					<SplitView.Pane>
						<StackPanel Orientation="Vertical" Spacing="5" HorizontalAlignment="Stretch">
							<Button Width="32" Height="32" Command="{Binding PaneOpenCommand}" Margin="7, 10">
								<PathIcon Height="11" Data="{StaticResource Navigation}" />
							</Button>
							<ListBox ItemsSource="{Binding Pages}" SelectedItem="{Binding SelectedPage}" Margin="2, 0, -100, 0" SelectedValue="1">
								<ListBox.Styles>
									<Style Selector="ListBoxItem">
										<Setter Property="Padding" Value="12, 8"></Setter>
									</Style>
								</ListBox.Styles>
								<ListBox.ItemTemplate>
									<DataTemplate x:DataType="{x:Type vm:PageTemplate}">
										<StackPanel Spacing="17" Orientation="Horizontal">
											<PathIcon Data="{Binding Icon}" Width="14"/>
											<TextBlock Text="{Binding Label}"/>
										</StackPanel>
									</DataTemplate>
								</ListBox.ItemTemplate>
							</ListBox>
						</StackPanel>
					</SplitView.Pane>
					<SplitView.Content>
						<Border CornerRadius="12">
							<TransitioningContentControl Content="{Binding CurrentPage}"/>
						</Border>
					</SplitView.Content>
				</SplitView>
			</Grid>
		</Panel>
		<Border Height="8" VerticalAlignment="Bottom" Background="Transparent" Tag="South"
                Cursor="SizeNorthSouth" PointerPressed="Resize_PointerPressed"/>

		<Border Width="8" HorizontalAlignment="Right" Background="Transparent" Tag="East"
                Cursor="SizeWestEast" PointerPressed="Resize_PointerPressed"/>

		<Border Width="8" HorizontalAlignment="Left" Background="Transparent" Tag="West"
                Cursor="SizeWestEast" PointerPressed="Resize_PointerPressed"/>

		<Border Height="8" VerticalAlignment="Top" Background="Transparent" Tag="North"
                Cursor="SizeNorthSouth" PointerPressed="Resize_PointerPressed"/>

		<Border Width="8" Height="8" HorizontalAlignment="Right" VerticalAlignment="Bottom" Tag="SouthEast"
                Background="Transparent" Cursor="BottomRightCorner" PointerPressed="Resize_PointerPressed"/>

		<Border Width="8" Height="8" HorizontalAlignment="Left" VerticalAlignment="Bottom" Tag="SouthWest"
                Background="Transparent" Cursor="BottomLeftCorner" PointerPressed="Resize_PointerPressed"/>

		<Border Width="8" Height="8" HorizontalAlignment="Right" VerticalAlignment="Top" Tag="NorthEast"
                Background="Transparent" Cursor="TopRightCorner" PointerPressed="Resize_PointerPressed"/>

		<Border Width="8" Height="8" HorizontalAlignment="Left" VerticalAlignment="Top" Tag="NorthWest"
                Background="Transparent" Cursor="TopLeftCorner" PointerPressed="Resize_PointerPressed"/>
	</Grid>
</views:UndertaleWindow>
